@startuml MER_SaaS
!define TABLENAME(x) class x << (T, #FFD700) >>
skinparam backgroundColor #FEFEFE
skinparam classBackgroundColor #F0F0F0

TABLENAME(USUARIO) {
  id : BIGINT <<PK>>
  email : VARCHAR <<UNIQUE>>
  nombre : VARCHAR
  apellido : VARCHAR
  password : VARCHAR
  fechaRegistro : TIMESTAMP
}

TABLENAME(PERFIL) {
  id : BIGINT <<PK>>
  usuario_id : BIGINT <<FK>>
  telefono : VARCHAR
  empresa : VARCHAR
  pais : VARCHAR
  fechaCreacion : TIMESTAMP
  fechaActualizacion : TIMESTAMP
}

TABLENAME(PLAN) {
  id : BIGINT <<PK>>
  nombre : VARCHAR <<UNIQUE>>
  precio : DOUBLE
  descripcion : VARCHAR
  limiteUsuarios : INT
  limiteProyectos : INT
  fechaCreacion : TIMESTAMP
}

TABLENAME(SUSCRIPCION) {
  id : BIGINT <<PK>>
  usuario_id : BIGINT <<FK>>
  tipoPlan : ENUM
  estado : ENUM
  fechaInicio : TIMESTAMP
  fechaProximoRenovacion : TIMESTAMP
  fechaCancelacion : TIMESTAMP
}

TABLENAME(FACTURA) {
  id : BIGINT <<PK>>
  usuario_id : BIGINT <<FK>>
  suscripcion_id : BIGINT <<FK>>
  monto : NUMERIC
  numeroFactura : VARCHAR <<UNIQUE>>
  estado : VARCHAR
  fechaEmision : TIMESTAMP
  fechaVencimiento : TIMESTAMP
}

TABLENAME(PAGO) {
  id : BIGINT <<PK>>
  factura_id : BIGINT <<FK>>
  tipoPago : ENUM
  monto : NUMERIC
  estado : VARCHAR
  fechaPago : TIMESTAMP
}

TABLENAME(PAGO_TARJETA) {
  id : BIGINT <<FK>>
  numeroTarjeta : VARCHAR
  titular : VARCHAR
  fechaVencimiento : VARCHAR
}

TABLENAME(PAGO_PAYPAL) {
  id : BIGINT <<FK>>
  cuentaPayPal : VARCHAR
  transactionId : VARCHAR
}

TABLENAME(PAGO_TRANSFERENCIA) {
  id : BIGINT <<FK>>
  numeroConversacion : VARCHAR
  banco : VARCHAR
  titularCuenta : VARCHAR
}

USUARIO ||--|| PERFIL : "1:1"
USUARIO ||--|| SUSCRIPCION : "1:1"
USUARIO ||--o{ FACTURA : "1:N"
SUSCRIPCION ||--o{ FACTURA : "1:N"
FACTURA ||--o{ PAGO : "1:N"
PAGO ||--|| PAGO_TARJETA : "Herencia"
PAGO ||--|| PAGO_PAYPAL : "Herencia"
PAGO ||--|| PAGO_TRANSFERENCIA : "Herencia"

@enduml
